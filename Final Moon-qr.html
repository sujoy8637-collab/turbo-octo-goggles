<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>This Rose — Sujoy (fix)</title>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&family=Great+Vibes&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#040414;
    --text:#f3f8ff;
    --muted: rgba(220,230,245,0.72);
    --gold-1:#ffd27a;
    --gold-2:#f7b500;
  }
  *{box-sizing:border-box; -webkit-tap-highlight-color: rgba(0,0,0,0);}
  html,body{height:100%;margin:0;font-family:"Poppins",sans-serif;background:linear-gradient(180deg,#020114,#01010a);color:var(--text);display:flex;align-items:center;justify-content:center;padding:14px;}
  .frame{ width:min(940px,96vw); height:min(820px,94vh); position:relative; border-radius:18px; overflow:hidden; box-shadow:0 30px 90px rgba(0,0,0,0.7); background:linear-gradient(180deg, rgba(6,8,18,0.55), rgba(2,3,8,0.75)); touch-action: manipulation; -webkit-user-select:none; user-select:none; }

  /* screens */
  .screen{ position:absolute; inset:0; display:flex; align-items:center; justify-content:center; text-align:center; padding:36px; transition: opacity .65s cubic-bezier(.2,.9,.2,1), transform .65s ease; opacity:0; pointer-events:none; transform: translateY(12px); }
  .screen.active{ opacity:1; pointer-events:auto; transform: translateY(0); }
  .panel{ max-width:820px; margin:0 auto; }
  .title{ font-size:clamp(20px,3.4vw,36px); font-weight:600; line-height:1.22; text-shadow:0 10px 30px rgba(0,0,0,0.56); }
  .subtitle{ margin-top:12px; color:var(--muted); font-size:clamp(13px,2vw,16px); opacity:0.92; }

  /* moon visual */
  .moon-halo{ position:absolute; left:50%; top:-6%; transform:translateX(-50%); width:820px; height:820px; border-radius:50%; background:radial-gradient(circle, rgba(180,210,255,0.28), rgba(150,180,255,0.12) 40%, transparent 75%); filter:blur(72px); mix-blend-mode:screen; z-index:1; opacity:0.95; animation: haloPulse 8s ease-in-out infinite; }
  @keyframes haloPulse{ 0%{opacity:0.92}50%{opacity:1}100%{opacity:0.92} }

  .moon-wrap{ position:absolute; left:50%; top:6%; transform:translateX(-50%); z-index:3; pointer-events:none; }
  .moon{
    width:300px; height:300px; border-radius:50%;
    background-image: url('https://images.unsplash.com/photo-1542877362-5f5f0d2b69b8?auto=format&fit=crop&w=1400&q=80');
    background-size:cover; background-position:center;
    box-shadow: 0 0 90px 32px rgba(160,190,255,0.18), inset 0 0 40px rgba(255,255,255,0.2);
    filter: drop-shadow(0 22px 70px rgba(10,30,60,0.28));
    animation: float 6s ease-in-out infinite;
  }
  @keyframes float{ 0%{transform:translateY(0)}50%{transform:translateY(-10px)}100%{transform:translateY(0)} }

  /* rose halo (subtle for first screen) */
  .rose-halo{ position:absolute; left:50%; top:6%; transform:translateX(-50%); width:700px; height:700px; border-radius:50%; background:radial-gradient(circle, rgba(255,200,220,0.06), transparent 45%); filter:blur(46px); z-index:1; mix-blend-mode:screen; opacity:0.95; }

  /* CTA */
  .cta{ position:absolute; bottom:22px; left:50%; transform:translateX(-50%); display:flex; gap:12px; align-items:center; cursor:pointer; z-index:12; transition:opacity .45s ease, transform .45s ease; pointer-events:auto; }
  .cta.hidden{ opacity:0; transform:translateY(12px) scale(.98); pointer-events:none; }
  .dot{ width:14px; height:14px; border-radius:50%; background: radial-gradient(circle,#fff,#ffd6e0); box-shadow:0 0 12px 6px rgba(255,170,190,0.10); animation:pulse 2600ms infinite; opacity:0.95; }
  @keyframes pulse{0%{transform:scale(1)}60%{transform:scale(1.45);opacity:.45}100%{transform:scale(1)} }

  /* gold signature (bottom-right) */
  .signature{ position:absolute; right:22px; bottom:18px; font-family:"Great Vibes",cursive; font-size:30px; z-index:12; text-align:right;
    background: linear-gradient(90deg,var(--gold-1) 0%, var(--gold-2) 50%, var(--gold-1) 100%);
    -webkit-background-clip: text; background-clip: text; color: transparent;
    text-shadow: 0 6px 18px rgba(247,181,0,0.08), 0 2px 6px rgba(0,0,0,0.45);
    animation: goldShine 4s ease-in-out infinite;
    opacity:0.98;
    pointer-events:auto; /* clickable but we ignore it in listener */
  }
  .signature::after{ content:""; position:absolute; right:-8px; top:-8px; width:12px; height:12px; border-radius:50%; background: radial-gradient(circle, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.6) 10%, transparent 40%); filter: blur(6px); opacity:0.9; animation: shimmer 4s ease-in-out infinite; transform: translateX(0); }
  @keyframes goldShine{ 0%{ filter:brightness(.95) }50%{ filter:brightness(1.18) }100%{ filter:brightness(.95) } }
  @keyframes shimmer{ 0%{opacity:0}30%{opacity:1; transform:translateX(-6px)}70%{opacity:.6; transform:translateX(-2px)}100%{opacity:0; transform:translateX(0)} }

  /* handwritten hint (final screen) */
  .hint{
    position:absolute;
    right:24px;
    bottom:56px;
    font-family:"Great Vibes",cursive;
    font-size:18px;
    color: rgba(235,230,210,0.86);
    text-align:right;
    opacity:0;
    transform:translateY(6px);
    transition: all .9s ease;
    z-index:12;
    letter-spacing:0.4px;
    pointer-events:none;
  }

  .hint.show{ opacity:0.95; transform:translateY(0); }

  /* ripple feedback */
  .ripple{
    position:absolute;
    border-radius:50%;
    transform: translate(-50%, -50%) scale(0.6);
    background: radial-gradient(circle, rgba(255,255,255,0.12), transparent 40%);
    pointer-events:none;
    z-index:20;
    width:120px; height:120px; opacity:0;
    transition: opacity .45s ease, transform .55s ease;
  }

  /* Particles */
  canvas.particles{ position:absolute; inset:0; z-index:0; pointer-events:none; filter:blur(.9px) saturate(120%); mix-blend-mode:screen; }

  /* responsive */
  @media (max-width:520px){
    .moon{ width:200px; height:200px }
    .signature{ font-size:22px; right:12px; bottom:10px; }
    .hint{ font-size:16px; right:12px; bottom:44px; }
    .ripple{ width:84px; height:84px; }
  }
</style>
</head>
<body>
  <div class="frame" id="frame" role="application" aria-label="Rose to Moon animation">

    <canvas id="particles" class="particles" aria-hidden="true"></canvas>

    <!-- Screen 1 (text only) -->
    <section id="screen-1" class="screen active" aria-label="intro">
      <div class="rose-halo" aria-hidden="true"></div>
      <div class="panel" role="main">
        <div class="title">This rose is for respect.<br><strong style="display:block;margin-top:10px">For Gunja.</strong></div>
        <div class="subtitle" style="margin-top:14px; opacity:0.9">A small gesture — nothing more, nothing less.</div>
      </div>
    </section>

    <!-- Screen 2 (moon - initial) -->
    <section id="screen-2" class="screen" aria-label="moon">
      <div class="moon-halo" aria-hidden="true"></div>
      <div class="moon-wrap" aria-hidden="true"><div class="moon" aria-hidden="true"></div></div>

      <div class="panel">
        <div class="title" id="line-main">Some things are meant to be found…<br><strong style="display:block;margin-top:8px">not given.</strong></div>
        <div class="subtitle" id="sub-main" style="opacity:0">Tap to continue — or keep reading if you like quiet things.</div>
      </div>
    </section>

    <!-- Screen 3 (moon - message) -->
    <section id="screen-3" class="screen" aria-label="message">
      <div class="panel">
        <div class="title" id="line-2">If you’re reading this, <strong>Gunja</strong>…<br><strong style="display:block;margin-top:8px">maybe the universe wanted our paths to cross.</strong></div>
      </div>
    </section>

    <!-- Screen 4 (final) -->
    <section id="screen-4" class="screen" aria-label="final">
      <div class="panel">
        <div class="title" id="final-main">Not a confession.<br><strong style="display:block;margin-top:8px">Not a question.<br>Just a truth you deserved to know.</strong></div>
      </div>
    </section>

    <div class="signature" id="signature">— Sujoy</div>
    <div class="hint" id="hint">“Sometimes…<br>connections find their way — quietly.”</div>

    <div class="cta" id="cta" role="button" tabindex="0" aria-label="tap to continue">
      <div class="dot" aria-hidden="true"></div>
      <div style="color:var(--muted); font-size:14px">tap to continue</div>
    </div>

    <div class="ripple" id="ripple" aria-hidden="true"></div>
  </div>

  <!-- soft piano (copyright-free) -->
  <audio id="bg-audio" src="https://files.catbox.moe/7bzf1v.mp3" preload="auto" loop></audio>

<script>
/* Particles (softer, slower) */
(function(){
  const c = document.getElementById('particles');
  const ctx = c.getContext('2d');
  let w,h,particles=[];
  function resize(){ w = c.width = c.clientWidth; h = c.height = c.clientHeight; }
  window.addEventListener('resize', resize);
  resize();
  function rand(a,b){ return Math.random()*(b-a)+a; }
  function make(){ return { x:rand(0,w), y:rand(0,h), r:rand(0.6,3.4)*rand(0.6,1.1), vx:rand(-0.02,0.02), vy:rand(0.005,0.08), a:rand(0.02,0.6) }; }
  for(let i=0;i<70;i++) particles.push(make());
  function draw(){
    ctx.clearRect(0,0,w,h);
    for(const p of particles){
      p.x += p.vx; p.y -= p.vy;
      if(p.x < -10) p.x = w+10;
      if(p.x > w+10) p.x = -10;
      if(p.y < -10) p.y = h+10;
      if(p.y > h+10) p.y = -10;
      const g = ctx.createRadialGradient(p.x,p.y,0,p.x,p.y,p.r*6);
      g.addColorStop(0, `rgba(235,245,255,${Math.min(0.95,p.a)})`);
      g.addColorStop(1, `rgba(170,200,255,${Math.max(0.02,p.a*0.06)})`);
      ctx.fillStyle = g;
      ctx.beginPath(); ctx.arc(p.x,p.y,p.r,0,Math.PI*2); ctx.fill();
    }
    requestAnimationFrame(draw);
  }
  draw();
})();

/* Screen flow + audio fade-in + robust event handling */
(function(){
  const screens = [
    document.getElementById('screen-1'),
    document.getElementById('screen-2'),
    document.getElementById('screen-3'),
    document.getElementById('screen-4'),
  ];
  const frame = document.getElementById('frame');
  const cta = document.getElementById('cta');
  const audio = document.getElementById('bg-audio');
  const hint = document.getElementById('hint');
  const sig = document.getElementById('signature');
  const ripple = document.getElementById('ripple');
  let idx = 0;
  let audioStarted = false;
  let lastTap = 0;

  function show(i){
    screens.forEach((s,j)=> s.classList.toggle('active', i===j));
    if(i===1){
      const sub = document.getElementById('sub-main');
      setTimeout(()=> sub.style.opacity = '1', 420);
    }
    if(i===3){
      setTimeout(()=> hint.classList.add('show'), 450);
    } else {
      hint.classList.remove('show');
    }
  }

  function fadeInAudio(targetVolume = 0.45, duration = 3000){
    if(!audio) return;
    audio.volume = 0;
    const start = Date.now();
    function step(){
      const t = Math.min(1, (Date.now() - start) / duration);
      audio.volume = t * targetVolume;
      if(t < 1) requestAnimationFrame(step);
    }
    step();
  }

  function startAudioOnce(){
    if(audioStarted) return;
    audioStarted = true;
    audio.play().catch(()=>{/* ignore */});
    fadeInAudio(0.45, 3000);
  }

  function next(){
    if(idx < screens.length - 1){
      idx++;
      show(idx);
      if(idx === screens.length - 1){
        cta.classList.add('hidden');
      }
    } else {
      const el = screens[idx];
      el.animate([{transform:'scale(1)'},{transform:'scale(1.01)'},{transform:'scale(1)'}], {duration:450, easing:'ease-out'});
    }
  }

  // show initial
  show(0);

  // ripple visual feedback
  function showRipple(x,y){
    ripple.style.left = x + 'px';
    ripple.style.top = y + 'px';
    ripple.style.opacity = '1';
    ripple.style.transform = 'translate(-50%, -50%) scale(0.6)';
    setTimeout(()=>{ ripple.style.transform = 'translate(-50%, -50%) scale(1)'; ripple.style.opacity = '0'; }, 10);
  }

  // unified tap handler
  function handleTap(ev){
    try{
      // prevent double events (click + touch)
      const now = Date.now();
      if(now - lastTap < 220) return;
      lastTap = now;

      // get coordinates for ripple
      let x = window.innerWidth/2, y = window.innerHeight - 80;
      if(ev.touches && ev.touches[0]){ x = ev.touches[0].clientX; y = ev.touches[0].clientY; }
      else if(ev.clientX && ev.clientY){ x = ev.clientX; y = ev.clientY; }

      // ignore taps on signature area
      const rect = sig.getBoundingClientRect();
      if(x >= rect.left && x <= rect.right && y >= rect.top && y <= rect.bottom){
        // tapped signature — do nothing (so user can admire it)
        showRipple(x,y);
        return;
      }

      showRipple(x,y);
      // start audio & advance
      startAudioOnce();
      next();
    }catch(e){
      // safe fail
      console.warn('tap handler error', e);
      startAudioOnce();
      next();
    }
  }

  // attach robust listeners
  // pointerup covers mouse and stylus; touchend covers mobile; click as final fallback
  frame.addEventListener('pointerup', function(e){ e.preventDefault(); handleTap(e); }, {passive:false});
  frame.addEventListener('touchend', function(e){ e.preventDefault(); handleTap(e); }, {passive:false});
  frame.addEventListener('click', function(e){ /* click as fallback */ handleTap(e); });

  // keyboard on CTA
  cta.addEventListener('keydown', function(ev){ if(ev.key === 'Enter' || ev.key === ' '){ ev.preventDefault(); startAudioOnce(); next(); } });

})();
</script>
</body>
</html>